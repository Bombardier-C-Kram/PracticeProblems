<!doctype html>
<html>
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<link rel="icon" href="/img/favicon.png" sizes="64x64">
	<title>
	
	
	User Defined Functions - Learn Dyalog APL
	
	</title>
	<script>
	window.MathJax = {
		tex: {inlineMath: [["@@", "@@"]],displayMath: [["%%","%%"]]},
		svg: {fontCache: 'global'}
	};
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/alerts.css">
	<link rel="stylesheet" href="/css/hints.css">
	<link rel="stylesheet" href="/css/print.css">
</head>
<body>
    <div>	
		<div id="navbar">
    <script>        
        window.onload = function(){
            let p = document.querySelectorAll(".problem");p[0].style.display = "block";
            let b = document.querySelectorAll(".pbutton");b[0].classList.add("active");
            b.forEach(fn=btn=>{
                btn.innerHTML = btn.innerHTML.trim().replace(/^P/, "").replace(/^\d/,"$&:").split("_").join(" ");
            });
            p.forEach(fn=pbm=>{
                let pdiv = document.createElement("div");   
                let pi = document.createElement("input");
                pi.id = pbm.id + "_Input";                             
                let sub = document.createElement("button");
                sub.onclick = function(){
                    submitSolution(pbm.id);
                }
                sub.innerHTML = "Submit";
                let odiv = document.createElement("div")
                odiv.id = pbm.id + "_Output";
                pbm.append(pi);
                pbm.append(sub);
                pbm.append(odiv);
                pbm.append(pdiv);                
            });
            loadTestCases("User Defined Functions");
        }
        function show(id) {
            let p = document.querySelectorAll(".problem");
            let b = document.querySelectorAll(".pbutton");
            for (let i=0; i<p.length; i++){                
                if (id == p[i].id) {
                    p[i].style.display = "block";
                    b[i].classList.add("active");
                    console.log(b[i]);
                } else {
                    p[i].style.display = "none";
                    b[i].classList.remove("active");
                }
            }
        }
    </script>
	<a id="back" href="/">Home</a>
	<br>
    
    
        
            <br><a href="/psets/2020.html">2020</a>
        
    
        
            <br><a href="/psets/2019.html">2019</a>
        
    
        
            <br><a href="/psets/2018.html">2018</a>
        
    
        
            <br><a href="/psets/2017.html">2017</a>
        
    
    
    
</div>

    </div>
    <div>Some contente efuhskeff</div>
	<div class="course-content">
	<h2 id="the-three-function-styles">The Three Function Styles</h2>

<p>So far, we have been reading and writing <a href="https://aplwiki.com/wiki/Dfn">dfns</a>.</p>

<pre><code class="language-APL">         3 {⍺+⍵} 5              ⍝ Left argument ⍺, right argument ⍵
           {⍵&gt;0:⍵,∇ ⍵-1 ⋄ ⍵}5   ⍝ Guard is : (colon). The function itelf is ∇ (del)
      Fn ← {⍺⍵}                 ⍝ We can give functions names
</code></pre>

<p>It is also possible to name functions without explicitly referring to their arguments. This is called <a href="https://aplwiki.com/wiki/Tacit_programming">tacit</a> or <em>point-free</em> programming.</p>

<pre><code class="language-APL">      Plus ← +
      IndicesTo ← ⍳
      _Reduce ← /      
      Sum ← Plus Reduce
      Sum IndicesTo 10
</code></pre>

<p>There is a neat syntax for composing functions called <a href=""><em>trains</em></a>. We won’t look at them in detail now, but they allow some rather neat ways to write short functions.</p>

<pre><code class="language-APL">      Mean ← +⌿ ÷ ≢         ⍝ The sum divided by the count
      Mean 3 1 4 1
      3 (+,-) 5             ⍝ Plus and minus
      ','(≠⊆⊢)'some,text'   ⍝ Split on commas
</code></pre>

<p class="alert alert-note">
<span class="alert-symbol">i</span>
<strong>Note:</strong>
Small unnamed dfns and tacit functions expand your vocabulary. One of my favourites is the "split by delimiter" train <code class="language-APL">(≠⊆⊢)</code>. A similar phrase which can take multiple delimiters can be found on <a href="https://aplcart.info/?q=split%20text#">aplcart.info</a>
</p>

<h2 id="traditional-functions">Traditional functions</h2>

<p>Dyalog is a modern APL implementation. Original APL implementations had a way of defining functions with a header line and named arguments and results. Since the introduction of dfns, functions of the original style are called <em>tradfns</em>.</p>

<pre><code class="language-APL">      Mean ← +⌿÷≢
      Mean ← {(+⌿⍵)÷≢⍵}
      ∇ m ← mean a
        m ← (+⌿a) ÷ ≢a
      ∇
</code></pre>

<p>A tradfn header reflects the calling syntax of the function. Reflects how the function is used.</p>

<pre><code class="language-APL">      ∇ {result} ← {optional} TradFn argument;local      
        :If 0=⎕NC'optional'
           optional ← 'no left argument'
        :EndIf
        local ← optional argument
        result ← local local        
      ∇      
</code></pre>

<p>Try calling <code class="language-plaintext highlighter-rouge">TradFn</code> with one and two arguments. How can we get the result to display to the session?</p>

<p>Here is the smallest tradfn:</p>
<pre><code class="language-APL">      ∇ T
      ∇
</code></pre>

<p><code class="language-plaintext highlighter-rouge">T</code> is a function which takes no arguments, returns no results and has no effects.</p>

<p>Results in <code class="language-plaintext highlighter-rouge">{}</code> curly braces do not print to the session by default, but can be passed to arguments. To ease debugging and write functions with predictable behaviour, it is generally best not to use shy results.</p>

<p>Optional left arguments are a little awkward in tradfns. The dfn equivalent is a little nicer looking: <code class="language-plaintext highlighter-rouge">{⍺←'default' ⋄ ⍺,⍵}</code>.</p>

<p>While usage of different function styles varies throughout many, I suggest the following non-prescriptive guidelines.</p>

<h4 id="dfns">dfns</h4>
<p><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjp8_Krx77qAhW8SEEAHXtQAyoQFjAAegQIBBAB&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPure_function&amp;usg=AOvVaw2dwW-CHbjpaA2b5N5TqK8h">pure functions</a></p>

<h4 id="tacit">tacit</h4>
<p>Best as short, <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjp8_Krx77qAhW8SEEAHXtQAyoQFjAAegQIBBAB&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPure_function&amp;usg=AOvVaw2dwW-CHbjpaA2b5N5TqK8h">pure functions</a>, performing some specific task such as data transformation.</p>

<p>However, sometimes a simple file reading (from trains webinar) is a reasonable use of a train interacting with the file system.</p>

<h4 id="tradfns">tradfns</h4>
<p>Best used as program control for dealing with system interactions. The use of control structures can make procedural tasks easier to debug. For example, if an error occurs when processing files using <code class="language-plaintext highlighter-rouge">¨</code> each.</p>

<pre><code class="language-APL">      ⍝ Write three text files to disk called f0, f1, and f3
      'first file'⎕nput'f0'
      '2nd '⎕nput'f1'
      'oof'⎕nput'f3'
      
      {⊃⎕nget'f',⍕⍵}¨¯1+⍳3
FILE NAME ERROR: f2: Unable to open file ("No such file or directory")
      {⊃⎕NGET'f',⍕⍵}¨¯1+⍳3
        ∧
      
      'okay'⎕nput'f2'
      {⊃⎕nget'f',⍕⍵}¨¯1+⍳4
┌──────────┬────┬────┬───┐
│first file│2nd │okay│oof│
│          │    │    │   │
└──────────┴────┴────┴───┘
</code></pre>

<p class="alert alert-note">
<span class="alert-symbol">i</span>
<strong>Note:</strong>
💡 Use `Ctrl+Enter` to step through a multiline function.
</p>

<pre><code class="language-APL">∇  r←ReadFiles fnames;fn
   r←⍬                  
   :For fn :In fnames   
       r,←1⌷⎕NGET fn    
   :EndFor              
∇ 

      ⎕ndelete'f2'
      ReadFiles fnames
FILE NAME ERROR: f2: Unable to open file ("No such file or directory")
ReadFiles[3] r,←1⌷⎕NGET fn
                  ∧      
</code></pre>

<ul>
  <li>Program control</li>
  <li>System control</li>
  <li>File handling</li>
</ul>

<h3 id="choo-choo">Choo choo</h3>

<ol>
  <li>Translating functions
    <ol>
      <li>Convert the following dfns into trains
        <ol>
          <li><code class="language-plaintext highlighter-rouge">{⌈/≢¨⍵}</code></li>
          <li><code class="language-plaintext highlighter-rouge">{1+⍺-⍵}</code></li>
          <li><code class="language-plaintext highlighter-rouge">{∨/⍺∊⍵}</code></li>
          <li><code class="language-plaintext highlighter-rouge">{(⌽⍵)≡⍵}</code></li>
        </ol>
      </li>
      <li>Convert the following trains into dfns
        <ol>
          <li><code class="language-plaintext highlighter-rouge">(⌈/-⌊/)</code></li>
          <li><code class="language-plaintext highlighter-rouge">(+⌿÷1⌈≢)</code></li>
          <li><code class="language-plaintext highlighter-rouge">(⊢-|)</code></li>
          <li><code class="language-plaintext highlighter-rouge">(1∧⊢,÷)</code></li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<h3 id="which-style">Which style?</h3>
<p>The fnstyles</p>

<pre><code class="language-APL">      fnstyles←'named ' 'unnamed '∘.,'one-line ' 'multi-line '∘.,'tradfns' 'dfns' 'tacit'
</code></pre>

<ol>
  <li>
    <p>Replace invalid function styles in <code class="language-plaintext highlighter-rouge">fnstyles</code> with the emtpy character array <code class="language-plaintext highlighter-rouge">''</code>.</p>
  </li>
  <li>
    <p>From the validThink about which function style would be most appropriate in the following situations.</p>

    <ol>
      <li>Writing a function called <code class="language-plaintext highlighter-rouge">Start</code> which calls sub-functions.</li>
      <li>Sort an array in alphabetical order</li>
      <li></li>
    </ol>
  </li>
</ol>

	</div>
</body>
</html>
